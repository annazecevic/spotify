{
	"Golang errors": {
		"/src/services/storage-service/logger/logger.go": [
			{
				"line": 17,
				"column": 2,
				"error": "could not import gopkg.in/natefinch/lumberjack.v2 (invalid package name: \"\")"
			},
			{
				"line": 152,
				"column": 18,
				"error": "undefined: lumberjack"
			}
		]
	},
	"Issues": [
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion uint64 -\u003e int64",
			"file": "/src/services/storage-service/hdfs/client.go",
			"code": "226: \tif err == nil {\n227: \t\tavailableSpace = int64(fsInfo.Remaining)\n228: \t}\n",
			"line": "227",
			"column": "25",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/src/services/storage-service/logger/logger.go",
			"code": "170: func ensureFilePermissions(path string) {\n171: \tf, err := os.OpenFile(path, os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0600)\n172: \tif err == nil {\n",
			"line": "171",
			"column": "12",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "499",
				"url": "https://cwe.mitre.org/data/definitions/499.html"
			},
			"rule_id": "G117",
			"details": "Exported struct field \"JWTSecret\" (JSON key \"JWTSecret\") matches secret pattern",
			"file": "/src/services/storage-service/config/config.go",
			"code": "10: \tHDFSNamenode string\n11: \tJWTSecret    string\n12: \tMaxFileSize  int64\n",
			"line": "11",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/logger/logger.go",
			"code": "199: \n200: \tl.writer.Write(append(data, '\\n'))\n201: }\n",
			"line": "200",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/logger/logger.go",
			"code": "174: \t}\n175: \tos.Chmod(path, 0600)\n176: }\n",
			"line": "175",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/logger/logger.go",
			"code": "172: \tif err == nil {\n173: \t\tf.Close()\n174: \t}\n",
			"line": "173",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/hdfs/client.go",
			"code": "137: \t\tif err != nil {\n138: \t\t\treader.Close()\n139: \t\t\treturn nil, nil, fmt.Errorf(\"failed to seek: %w\", err)\n",
			"line": "138",
			"column": "4",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/hdfs/client.go",
			"code": "84: \tif size \u003e 0 \u0026\u0026 written != size {\n85: \t\tc.client.Remove(path)\n86: \t\treturn \"\", fmt.Errorf(\"size mismatch: expected %d, got %d\", size, written)\n",
			"line": "85",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/hdfs/client.go",
			"code": "79: \tif err != nil {\n80: \t\tc.client.Remove(path)\n81: \t\treturn \"\", fmt.Errorf(\"failed to write to HDFS: %w\", err)\n",
			"line": "80",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/handler/storage_handler.go",
			"code": "157: \n158: \tio.Copy(c.Writer, reader)\n159: }\n",
			"line": "158",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/src/services/storage-service/handler/storage_handler.go",
			"code": "115: \n116: \t\tio.Copy(c.Writer, reader)\n117: \t\treturn\n",
			"line": "116",
			"column": "3",
			"nosec": false,
			"suppressions": null
		}
	],
	"Stats": {
		"files": 6,
		"lines": 1137,
		"nosec": 0,
		"found": 11
	},
	"GosecVersion": "dev"
}